#!/bin/bash

CLMS_SCRIPT_FOLDER=/home/imperatoren/work/VIIRS_S2_comparison/viirsnow/src
OUTPUT_FOLDER=/home/imperatoren/work/VIIRS_S2_comparison/data/S2
HRSI_CREDENTIALS=/home/imperatoren/work/VIIRS_S2_comparison/viirsnow/scripts/clms_hrsi/hrsi_credentials.txt
REQUEST="https://cryo.land.copernicus.eu/resto/api/collections/HRSI/search.json?maxRecords=10&startDate=2023-10-01T00%3A00%3A00Z&completionDate=2024-09-01T23%3A59%3A59Z&productType=FSC&mission=S2&sortParam=startDate&sortOrder=descending&status=all&geometry=MULTIPOLYGON(((9.019647749629934+42.079717910747036%2C8.767347252919865+42.26752946302872%2C8.80536500981166+42.44624636604689%2C8.942505263189908+42.56189238671104%2C9.140840001983705+42.52408346141755%2C9.09736745379176+42.38197028055711%2C9.163901328320954+42.16222331443555%2C9.284105610467758+42.13340303858001%2C9.236796932302468+41.69379936609724%2C9.071428442744809+41.77866106136281%2C9.104966390522165+41.91463351005572%2C9.019134432832749+41.95796084262366%2C9.019647749629934+42.079717910747036))%2C((5.247452884168669+44.07824162848226%2C5.129095478501129+44.154156471152646%2C5.137155088611981+44.37028906491008%2C5.026691040170904+44.44700959590426%2C5.05332391608268+44.66295352985287%2C5.290285026572177+44.767036056998336%2C5.431989642987476+44.72923741930302%2C5.244421121124306+44.851353166562916%2C5.286469810599002+45.07478324113103%2C6.15575372788065+45.87750819127433%2C5.808158058182969+46.1143138493799%2C5.810987361087633+45.85806362023396%2C5.666459372108899+45.857349728455915%2C5.630545510104188+45.63596084436398%2C5.3709007429023625+45.873534069555376%2C5.501911954844851+46.260210821614464%2C5.446948414712171+46.27776844547853%2C5.502281852436123+46.56965390095465%2C5.95111480726852+47.19666264107224%2C6.734198101784661+47.471479117784696%2C6.933167546399569+47.4749418300367%2C6.896792308848958+47.36677229811346%2C7.071942609181886+47.33772503788876%2C6.734278336796331+47.04348565350418%2C6.4886840909201995+46.95815171206462%2C6.46779379616276+46.77077384905107%2C6.130341356123893+46.57848300072129%2C6.175320334400579+46.54650459409564%2C6.086218842661224+46.42273979471622%2C6.18235558571322+46.36901696122672%2C5.978026288609454+46.13347199500092%2C6.23427049156443+46.19361749780015%2C6.333685003746228+46.047425343993524%2C6.530452181336527+46.073371809419115%2C6.328470422930944+46.14853134831969%2C6.31337204760851+46.22845708597177%2C6.592527872519166+46.393685566707745%2C6.817986453005764+46.39454150322814%2C6.881699758530158+46.278118270718494%2C6.811181029270234+46.14282084653547%2C6.911852533904357+46.12725907381966%2C6.891331944158908+46.053819690666046%2C7.058718478735764+45.922590116705464%2C6.82958693973247+45.829148163939124%2C6.827911825031704+45.726823866646384%2C7.016036111953199+45.64517966323419%2C7.021025761965515+45.50947378659973%2C7.20277059617607+45.407326722468554%2C7.084144001817305+45.20736053466712%2C6.646838774472788+45.10645685434727%2C6.7691681453600445+44.914168372741216%2C7.018583405008739+44.84669270981067%2C7.0989112680379005+44.683242971158336%2C6.976869532991172+44.672242962687136%2C6.873161493776148+44.525833430616046%2C6.959461031338941+44.439787013753545%2C6.907320291253419+44.364807438304524%2C7.027336640015925+44.24067922192302%2C7.369299302479728+44.126404550009454%2C7.691826652837324+44.181698369088025%2C7.718260395624903+44.0375789365489%2C7.5814010944127705+43.97559062724781%2C7.129154246302093+44.06633870169853%2C7.180507559107898+43.763327495651964%2C6.377062565497246+43.55796942380593%2C6.173179273203189+43.64110758383882%2C5.946968967233925+44.03729293629942%2C5.646183365623587+43.875439917907244%2C5.199233918129992+43.95697495299123%2C5.247452884168669+44.07824162848226))%2C((6.617905741736314+47.76738756636192%2C6.755915443778362+47.88052554961064%2C6.627008909710642+47.93518107188547%2C6.722409469935861+48.00529801745873%2C6.589528666026074+48.033090336307396%2C6.598355553029442+48.13151869887494%2C7.067908145143648+48.23921256550912%2C7.094360513258108+48.30065655318833%2C6.994091927373268+48.29868713627292%2C6.934292131186197+48.409034477402685%2C7.300377691299897+48.67553147058314%2C7.39543719910403+48.59161886380065%2C7.289014896161631+48.51895815856%2C7.413947584765863+48.49893322461054%2C7.442169700084925+48.41755496182782%2C7.214390628460995+48.26102496354537%2C7.363664770670331+48.250657995812276%2C7.175339829761746+48.046851406042634%2C7.288160923114249+48.03378385739313%2C7.198080598108675+47.97133197388507%2C7.1913748984460755+47.84527690753393%2C6.777879659959439+47.693799481466584%2C6.593002957737872+47.718904272182755%2C6.617905741736314+47.76738756636192))%2C((2.166168379950199+43.52415067837083%2C2.411075133320942+43.525218280599546%2C2.34445943554242+43.63675180968397%2C2.407542728439763+43.898737876708566%2C2.681821486442634+43.962137788705746%2C2.534410192356426+44.0307117727578%2C2.5005959634394572+44.23223890570526%2C2.21956390037854+44.245300660370674%2C2.148561774681006+44.34025630567265%2C2.973553606861048+44.46772979782847%2C2.63316123796667+44.57479748828723%2C2.5827435655925113+44.6581366125709%2C2.7255246649490985+44.80715963257259%2C2.497173420666402+44.67145816129599%2C2.300990521012844+44.831978447263964%2C2.20245456669837+45.15313542465293%2C2.642995147798823+45.36007557339926%2C2.363050361031214+45.445480909436355%2C2.365930703121929+45.37715792664875%2C2.210533846850969+45.329650525055484%2C1.960061700548793+45.35026985277656%2C1.7623343326291812+45.462015380454346%2C1.723481670861217+45.655386101785155%2C1.811149616483026+45.98397504793397%2C2.116318757797524+45.97508289332825%2C2.443406126707302+46.09621347160862%2C2.4898072920646106+46.00010115224342%2C2.826688112545181+46.22833242329466%2C3.012676531043843+46.20123515044213%2C3.05545162805587+45.53699795419678%2C3.226750968648923+45.384393396183924%2C3.137470452959376+45.236897154816575%2C3.299416866605722+45.26171342961868%2C3.607060030344841+45.01193725341915%2C3.3730088261573252+45.509820677598896%2C3.519726027011815+45.668913097074096%2C3.714403262308996+45.62125008031606%2C3.755934303768931+45.39825631625203%2C3.7772525412825924+45.58060697546995%2C3.53069036272407+45.91933476597495%2C3.754723837992842+46.15122699988433%2C3.904067503521344+46.07149736127823%2C4.037668948642+45.552318943302225%2C4.194922335832602+45.400475963652184%2C3.9729356976572574+45.209440328847194%2C4.339315598137259+45.40662501708263%2C4.687197110005074+45.479653244566805%2C4.612327359263777+45.02063678575249%2C4.502231830392248+45.02840503059946%2C4.4975955867634+44.92966991663968%2C4.395077213357751+44.91689193702922%2C4.521198916653295+44.871353729976505%2C4.480535860329908+44.72970548742856%2C4.209189494320862+44.694877903336845%2C4.221844364347892+44.60978855208299%2C4.038456165360444+44.429013721271815%2C3.946972459026118+44.527397607904504%2C3.9858152824708872+44.19120989456124%2C3.734929325948831+44.12475213195279%2C3.8404718485035434+44.06960521304697%2C3.7858070418554153+43.97266959779134%2C3.684319041152637+44.05049250965021%2C3.5229288532027496+43.980911767917576%2C3.6857871985751447+43.86402276027445%2C3.493498218732832+43.72292057618722%2C3.137792665004852+43.76110210973155%2C3.155436439172785+43.56747595089732%2C2.892819685620657+43.42451572835938%2C2.5512816343531663+43.35938518435489%2C2.000558912467287+43.411314037053785%2C2.166168379950199+43.52415067837083))%2C((-1.36178107435679+43.03932852402124%2C-1.326955851688067+43.120261283089576%2C-1.042981470043685+43.16612948455261%2C-0.7793590519214691+43.04417519582407%2C-0.568591029216289+43.12630965661424%2C0.63474171565856+42.96123167113191%2C1.002524104304743+42.99197833139226%2C1.63117160958296+42.88655727584455%2C1.788026562833009+42.97393138746503%2C2.228626781795811+42.880317224142914%2C2.341873188791864+42.95924884713466%2C2.255407296797349+43.02388930820655%2C2.5124269344532344+43.064600816481374%2C2.619408857586995+42.823494807253354%2C2.427881354115343+42.79814672820069%2C2.593863020418842+42.715335422966945%2C2.422446260582256+42.5874522119197%2C2.617785306672266+42.51388553703157%2C2.687538141153726+42.34521256018729%2C2.3830994505683214+42.390802317442024%2C2.311234013359358+42.24483287595103%2C1.238514555700756+42.09426374654592%2C0.948977283152495+42.28887886874921%2C-0.410235798313025+42.42739309348093%2C-1.6251695702710678+43.064886448083826%2C-1.469940261194915+43.10020987491032%2C-1.36178107435679+43.03932852402124)))&dataset=ESA-DATASET"

python $CLMS_SCRIPT_FOLDER/clms_hrsi_downloader.py -query_and_download -queryURL $REQUEST -hrsi_credentials $HRSI_CREDENTIALS $OUTPUT_FOLDER

cd $OUTPUT_FOLDER
unzip "*.zip"
rm *.zip